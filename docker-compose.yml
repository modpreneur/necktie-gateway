version: '2'
services:
  gateway:
    build:
      context: .
      dockerfile: docker/dev/Dockerfile
    links:
      - mysql_database:mysql_database
      - rabbit_mq
    ports:
      - "9608:9608"
      - "9005:9005"
      - "8666:8666"
      - "9080:80"
    expose:
      - "9608"
      - "9005"
      - "8666"
      - "9080"
    volumes:
      - .:/var/app

#    external_links:
#      - necktie_rabbit_mq_1:rabbit_mq


  mysql_database:
    image: mysql
    ports:
      - "3307:3306"
    expose:
      - "3307"
    environment:
      - MYSQL_DATABASE=gateway
      - MYSQL_USER=user
      - MYSQL_PASSWORD=pass
      - MYSQL_ROOT_PASSWORD=pass


  rabbit_mq:
    build:
        context: ./docker/rabbitMQ/
    ports:
      - "5672:5672"
      - "15672:15672"


#networks:
#  default:
#    external:
#      name: necktie_default