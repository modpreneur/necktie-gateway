version: '2'
services:

  php_fpm:
    image: modpreneur/necktie-fpm-test:0.7
    links:
      - mysql:mysql
    ports:
      #php-fpm
      - "9080:80"
      #supervisor
      - "9005:9005"
    expose:
      - 9005
    volumes:
      - .:/var/app
    external_links:
      - necktietests_rabbit_mq_1:rabbit_mq

  nginx:
    image: modpreneur/necktie-nginx:0.3
    ports:
    #this port number is required by necktie tests, if changed change parameters.yml.dist on Necktie
        - 9080:80
    links:
        - php_fpm
    volumes_from:
        - php_fpm
    volumes:
      - ./logs/nginx/:/var/log/nginx

  mysql:
    extends:
      file: docker-compose.yml
      service: mysql

networks:
  default:
    external:
      name: necktietests_default